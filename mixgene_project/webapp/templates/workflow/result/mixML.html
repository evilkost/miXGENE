{% load static %}

<!-- expecting django variable  result -->

<div class="panel panel-default">
    <div class="panel-heading">
        <h3>{{ result.title }}</h3>
    </div>
    <div class="panel-body">
        <h5>Accuracy: {{ result.acc }}%.</h5>

        <div class="panel panel-default">
            <div class="panel-heading">
                 Obtained model:
            </div>
            <div class="panel-body">
                {{ result.model }}
            </div>
        </div>

        <b>Predictions:</b>
        <button class="btn" id="table_visibility_switch">
            <span class="tbs_text"> <span class="glyphicon glyphicon-chevron-up"> </span>Hide table </span>
            <span class="tbs_text" style="display: none"><span class="glyphicon glyphicon-chevron-down"></span>Show table </span>
        </button>
        <div  id="factor_table" > </div>

        <script type="text/javascript">
            $(function() {
                $(document).ready(function () {
                    var dataurl = '{% url 'get_csv_as_table' exp.pk result.filename %}';
                    function onDataReceived(response) {
                        $("#factor_table").html(response); // TODO: parameterise id & classes
                    }
                    $.ajax({
                        url: dataurl,
                        type: "POST",
                        data: {
                            csrfmiddlewaretoken: '{{ csrf_token }}',
                            has_row_names: true,
                            has_col_names: true,
                            get_header_from_ctx: true,
                            ctx_header_key: 'linsvm_header' // TODO: parameterise
                        },
                        dataType: "html",
                        success: onDataReceived
                    });
                });
            });
            $(function() {
                $("#table_visibility_switch").click(function(){
                    $("#factor_table").toggle();
                    $(".tbs_text").toggle();
                });
            });
        </script>
    </div>
</div>
